<html lang="zh-cmn"><head><meta charset="UTF-8">  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover"><meta name="renderer" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta content="no-siteapp" http-equiv="Cache-Control"><script>var __START_DATE = +new Date</script>  <title>企业微信</title> <link rel="icon" type="image/png" sizes="16x16" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/independent/favicon/favicon_16h$faede2cd.png"> <link rel="icon" type="image/png" sizes="32x32" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/independent/favicon/favicon_32h$a41a4426.png"> <link rel="icon" type="image/png" sizes="48x48" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/independent/favicon/favicon_48h$c976bd14.png"> <script type="text/javascript" src="//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/tagEventHandler$7db5c159.js"></script>  <link rel="stylesheet" type="text/css" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/css/_$$_login.merge$0ac16cf8.css,hotfix$d41d8cd9.css">   <link rel="prefetch" as="style" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/css/main.merge$24b1ce68.css"> <link rel="prefetch" as="style" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/css/jstree-style$a4440c11.css"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/icons$526600ac.png"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/icons_2x$80720ccf.png"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/icons$9d2247b3.svg"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/commonImages$e39ac2ab.png"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/commonImages_2x$5b516c39.png"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/indexImages$47d95feb.png"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/indexImages_2x$d0508a1e.png"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/indexImages$07c08080.svg"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/independent/frame_index/qr_code$778d7508.svg"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/independent/Loading_20h$c301f555.gif"> <link rel="prefetch" as="image" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/style/images/independent/index/WeWorkTeamQRcode$c2333c0c.png"> <link rel="prefetch" as="script" href="//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/3rd/soundmanager2-official$c7b0e7e7.js">   <script>var RES_CDN = '//wwcdn.weixin.qq.com'</script>  <script src="//js.aq.qq.com/js/aq_common.js"></script>  <!--[if lte IE 8]> <script type="text-xmind-csv/javascript" src="//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/3rd/supportHtml5$6f7a22f4.js"></script> <![endif]--><script>var __HEAD_END_DATE = +new Date</script>  </head><body class="frame_wrap lang_zh-cn"><script>var isWin = (function()
{
var ua = navigator.userAgent.toLowerCase();
var isWin = (ua.indexOf('windows') != -1 || ua.indexOf('win32') != -1) && true;
if (isWin) document.body.className += ' isWin';
return isWin;
})();
function weLANG(msg, tpldata) {
msg += '';
if (!tpldata || !tpldata.length || msg.indexOf('%') == -1) return msg;
var replace_index = 0;
return msg.replace(/%s|%\{.+?\}/g, function() {
var newVal = tpldata[replace_index++];
return newVal === undefined ? '' : newVal;
});
}</script><div id="wework_admin.normal_layout_$" rendered="true"><div id="wework_admin.normal_layout$layout$"><div id="wework_admin.loginpage_wx_$" rendered="true">  <header class="login_head"><div class="login_head_inner"><a class="login_head_title" href="/">企业登录</a><span class="ww_loginImg ww_loginImg_LoginLogo"></span></div></header>  <main class="frame_cnt"><div class="frame_cnt_inside frame_cnt_inside_Small"><div class="login_stage">   <div class="login_wechat"><h2 class="login_stage_title">  <span class="login_stage_title_text">企业微信扫码登录</span></h2><div class="ww_wechatQrCode"><div class="ww_loadingIcon"></div><div class="login_wechat_qrcode ww_wechatQrCode_cnt" id="wx_reg"><iframe src="https://work.weixin.qq.com/wework_admin/wwqrlogin/mng/login_qrcode?login_type=login_admin&amp;callback=wwqrloginCallback_1627383535628&amp;redirect_uri=https%3A%2F%2Fwork.weixin.qq.com%2Fwework_admin%2Floginpage_wx%3Fpagekey%3D162738353562832%26redirect_uri%3Dhttps%253A%252F%252Fwork.weixin.qq.com%252Fwework_admin%252Fframe%23index&amp;crossorigin=1" frameborder="0" scrolling="no" width="300px" height="400px"></iframe></div>  <div class="login_wechat_notice" id="login_wechat_notice">同时支持微信扫码登录</div>  </div></div>   </div></div>  <div class="login_registerBar"><span class="login_registerBar_remind">没有帐号？</span><a class="login_registerBar_link" href="/wework_admin/register_wx?from=loginpage">企业注册</a></div>  </main><script>(function (){
// 灰度去除combo
var userAgent = window.navigator.userAgent || '';
// ie 内核不走 no combo ，因为基本不支持 http/2
if ( userAgent.toLowerCase().indexOf('trident/')  == -1 ) {
window.seajs_use_no_combo = true;
window.seajs_enable_report_cdn = true;
window.seajs_enable_success_cdn = true;
}
})()</script>  <footer class="frame_foot"><nav class="frame_foot_nav"><a class="frame_foot_nav_item" href="http://www.tencent.com/" target="_blank">关于腾讯</a><span class="frame_foot_nav_itemDep">|</span> <a class="frame_foot_nav_item" href="/eula" target="_blank">用户协议</a><span class="frame_foot_nav_itemDep">|</span> <a class="frame_foot_nav_item" href="/norm" target="_blank">使用规范</a><span class="frame_foot_nav_itemDep">|</span> <a class="frame_foot_nav_item" href="/privacy" target="_blank">隐私政策</a><span class="frame_foot_nav_itemDep">|</span> <a class="frame_foot_nav_item" href="/wework_admin/app_intro_list?type=mng&amp;from=frame_footer" target="_blank">更新日志</a><span class="frame_foot_nav_itemDep">|</span> <a class="frame_foot_nav_item" href="https://work.weixin.qq.com/help" target="_blank">帮助中心</a> <span class="frame_foot_nav_itemDep">|</span><div id="i18nDropdown" class="ww_btnWithMenu"><a class="qui_btn ww_btn i18n_dropdown ww_btn_Dropdown" href="javascript:;"><span class="ww_btn_Dropdown_label">中文</span><span class="ww_btn_Dropdown_arrow"></span></a><div class="qui_dropdownMenu ww_dropdownMenu i18n_dropdown_menu"><ul>  <li data-value="zh" data-index="0" class="qui_dropdownMenu_item ww_dropdownMenu_item   "><a href="javascript:;" class="qui_dropdownMenu_itemLink ww_dropdownMenu_itemLink"><span class="ww_commonImg ww_commonImg_TimePickerChecked"></span> <span class="ww_dropdownMenu_itemLink_text">中文</span></a></li>  <li data-value="en" data-index="1" class="qui_dropdownMenu_item ww_dropdownMenu_item   "><a href="javascript:;" class="qui_dropdownMenu_itemLink ww_dropdownMenu_itemLink"><span class="ww_commonImg ww_commonImg_TimePickerChecked"></span> <span class="ww_dropdownMenu_itemLink_text">English</span></a></li>  </ul></div></div></nav><p class="frame_foot_copyright">© 1998&nbsp;-&nbsp;2021&nbsp;Tencent Inc. All Rights Reserved</p></footer> <script>window.__LQ_REPORT_URL__ = '/wework_admin/report';
window.__DB_COMBO_FILE__ = '//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/var/global$8b60e04f.js';
window.process = { env: { NODE_ENV: 'production' } };
window.XSS_FW_CONFIG = {
reportOnly: false,
reportUrl: '/wework_admin/customReport/xssMonitor'
}</script> <script type="text/javascript" src="//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/var/global$8b60e04f.js"></script> <script src="//wwcdn.weixin.qq.com/node/wwmng/wwmng/_$$_js/3rd/badjs/bj-report-tryjs.min$17db1e6f.js,js/3rd/babel-polyfill$e06c5517.js,js/3rd/xss-firewall$356e4345.js,js/modules/jquery/jquery/1.11.3/jquery.min$b3c48411.js,comm/3rd/mail.seajs/sea$8d0a843e.js,js/id_check$09938851.js,js/lib/aegisFactory$021e0857.js" type="text/javascript"></script> <script src="https://wwcdn.weixin.qq.com/node/wework/js/sentry.5.5.0.min.js" crossorigin="anonymous"></script><script src="https://cdn-go.cn/aegis/aegis-sdk/latest/aegis.min.js?_bid=3977" crossorigin="anonymous"></script> <script type="text/javascript" src="//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/layout/footer$e296648f.js"></script> <script>seajs.use("//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/layout/footer.js", function(Footer)
{
Footer && (Footer.feedback());
})</script>  <script src="//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/layout/_$$_footer$e296648f.js,ww.cookie_banner/cookie_banner$0cd7daea.js" type="text/javascript"></script> <script eslint-disable="">window.login_from = '';
var indepBar = '';
if (indepBar) window.indepBar = indepBar</script>     <script>function WWQRLogin(options) {
var iframe = document.createElement("iframe");
var container = document.getElementById(options.id);
var login_type = options.login_type || 'login_admin';
var src = [
location.protocol, '//work.weixin.qq.com/wework_admin/wwqrlogin/mng/login_qrcode?',
'login_type=', login_type,
options.callback ? '&callback=' + options.callback : '',
'&redirect_uri=', options.redirect_uri
].join('')
document.domain = 'work.weixin.qq.com';
src += '&crossorigin=1';
src += options.style ? "&style=" + options.style: "";
iframe.src = src;
iframe.frameBorder = "0";
iframe.allowTransparency = "true";
iframe.scrolling = "no";
iframe.width = "300px";
iframe.height = "400px";
container.innerHTML = "";
container.appendChild(iframe)
}</script>  <script eslint-disable="">var  getQueryString =  function(name)
{
var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
var r = window.location.search.substr(1).match(reg);
if (r != null)return decodeURIComponent(r[2]);
return null;
}
void function()
{
var pagekey = +new Date;
pagekey += ''+(Math.random() * 1000 | 0);
var redirect_uri = location.protocol+"//work.weixin.qq.com/wework_admin/loginpage_wx?pagekey="+pagekey;
if (window.login_from) redirect_uri += '&from=' + encodeURIComponent(login_from);
if (window.indepBar) redirect_uri += '&indep_bar=' + encodeURIComponent(indepBar);
var redirect_uri_params = getQueryString("redirect_uri");
var mch_id = getQueryString("mch_id");
if(/pay.weixin.qq.com/g.test(redirect_uri_params)){
redirect_uri += "&redirect=" + encodeURIComponent(redirect_uri_params);
if(mch_id){
redirect_uri += "&mch_id=" + mch_id;
}
}  var wwqrloginCallback = 'wwqrloginCallback_' + Date.now();
var wxLogin = new WWQRLogin({
id: "wx_reg",
appid: "wx15f969e39a994efc",
scope: "snsapi_login",
callback: wwqrloginCallback,
state: encodeURIComponent("web_login@9"+location.hash),
redirect_uri: encodeURIComponent(redirect_uri+"&redirect_uri=" + encodeURIComponent("https://work.weixin.qq.com/wework_admin/frame") + (location.hash ? location.hash : '')),
style: '',
href: encodeURIComponent('https://'+location.host+'/wework_admin/wxauth/report/css?pagekey='+pagekey)
});
window[wwqrloginCallback] = function(options) {
var loginWechatNotice = document.getElementById('login_wechat_notice');
if (loginWechatNotice) {
if (options.status == 'new') {
loginWechatNotice.style.display = 'block';
} else {
loginWechatNotice.style.display = 'none';
}
}
}  }();
seajs.use("//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/lib/Tips.js", function(Tips)
{
if (getQueryString("show_type") == "show_scan")
{
// 这里不要改成weLANG字符串形式，这里的getQueryString是前端的，而weLANG是服务端逻辑，所以报函数找不到，容易出锅！
Tips.err("你不是企业微信管理员，请使用管理员"+ getQueryString("name")+"的微信扫码登录")
return ;
}
})</script>  <script>seajs.use("//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/lib/Tips.js", function(Tips) {
Tips.err("登录态过期，请重新登录");
})</script>   </div></div></div><script type="text/javascript" src="//wwcdn.weixin.qq.com/node/wwmng/wwmng/js/layout/ww.cookie_banner/analytics_js/work_domain/google_analytics$a0d2d65a.js"></script> <script>var langCookie = document.cookie.match(/(?:^|;) *wwrtx\.i18n_lan=([^;]+)/);
var langNameArr = null;
if (!langCookie) {
(new Image()).src = '/wework_admin/report?q='+ encodeURIComponent('st:logkvauto_report='+JSON.stringify({"kv":"44589", "key": navigator && navigator.userAgent}) ) + "&_t=" +  (new Date -0);
}
if (langCookie) {
langNameArr = langCookie[1].split('%2C');
}
if (langNameArr && langNameArr[0].indexOf('en') > -1) {
document.body.className = 'frame_wrap lang_en';
}
(function() {
var random = +(new Date());
var settings = window.settings;
if (settings && settings.vid && settings.corp_id) {
new Image(1, 1).src = '/wework_admin/report?type=img&r=' + random + '&q='+encodeURIComponent('st:pv_report='+JSON.stringify({
vid		: +settings.vid || undefined,
corpid	: +settings.corp_id || undefined,
refer	: document.referrer || undefined,
url		: window.location.href
}));
}
})()</script><div id="js_tips" class="ww_tip error ww_tip_Warning" style="z-index: 1000; margin-left: -91.5px;">登录态过期，请重新登录</div></body></html>
sh: ./launch_web.sh: No such file or directory

test_user_web.py:24 (TestUserweb.test_add_member_scene)
self = <test_user_web.TestUserweb object at 0x7fb991925ee0>

    @allure.story("成员管理-业务场景案例")
    @allure.title("添加成员-保存并继续-添加成员-保存")
    def test_add_member_scene(self):
        self.login.logging("-------------------------------- test_add_member_scene 开始 --------------------------------")
        with allure.step(
            "1、点击通讯录进入通讯录界面；\n"
            "2、点击页面上部添加成员按钮进入添加成员页面；\n"
            "3、输入成员姓名、帐号、手机号；"
        ):
            # 初始化成员1数据
            member1 = Utils.member_data()
            print(member1)
            self.login.logging(f"--------member2:{member1[0], member1[1], member1[2]}--------")
>           add_member1 = self.login.switch_index().click_contact_button().click_add_member_button()\
                .add_member(member1[0], member1[1], member1[2])

test_user_web.py:38:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../pages/Web/login_page.py:39: in switch_index
    if self.check_login() is True:
../../pages/Web/login_page.py:27: in check_login
    Cookies.get_cookies()
../../pages/Web/web.py:193: in get_cookies
    driver = webdriver.Chrome(options=opt)
../../venv/lib/python3.8/site-packages/selenium/webdriver/chrome/webdriver.py:76: in __init__
    RemoteWebDriver.__init__(
../../venv/lib/python3.8/site-packages/selenium/webdriver/remote/webdriver.py:157: in __init__
    self.start_session(capabilities, browser_profile)
../../venv/lib/python3.8/site-packages/selenium/webdriver/remote/webdriver.py:252: in start_session
    response = self.execute(Command.NEW_SESSION, parameters)
../../venv/lib/python3.8/site-packages/selenium/webdriver/remote/webdriver.py:321: in execute
    self.error_handler.check_response(response)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <selenium.webdriver.remote.errorhandler.ErrorHandler object at 0x7fb991ed4b80>
response = {'status': 500, 'value': '{"value":{"error":"unknown error","message":"unknown error: cannot connect to chrome at 127....fff2060f8fc _pthread_start + 224\\n19  libsystem_pthread.dylib             0x00007fff2060b443 thread_start + 15\\n"}}'}

    def check_response(self, response):
        """
        Checks that a JSON response from the WebDriver does not have an error.

        :Args:
         - response - The JSON response from the WebDriver server as a dictionary
           object.

        :Raises: If the response contains an error message.
        """
        status = response.get('status', None)
        if status is None or status == ErrorCode.SUCCESS:
            return
        value = None
        message = response.get("message", "")
        screen = response.get("screen", "")
        stacktrace = None
        if isinstance(status, int):
            value_json = response.get('value', None)
            if value_json and isinstance(value_json, basestring):
                import json
                try:
                    value = json.loads(value_json)
                    if len(value.keys()) == 1:
                        value = value['value']
                    status = value.get('error', None)
                    if status is None:
                        status = value["status"]
                        message = value["value"]
                        if not isinstance(message, basestring):
                            value = message
                            message = message.get('message')
                    else:
                        message = value.get('message', None)
                except ValueError:
                    pass

        exception_class = ErrorInResponseException
        if status in ErrorCode.NO_SUCH_ELEMENT:
            exception_class = NoSuchElementException
        elif status in ErrorCode.NO_SUCH_FRAME:
            exception_class = NoSuchFrameException
        elif status in ErrorCode.NO_SUCH_WINDOW:
            exception_class = NoSuchWindowException
        elif status in ErrorCode.STALE_ELEMENT_REFERENCE:
            exception_class = StaleElementReferenceException
        elif status in ErrorCode.ELEMENT_NOT_VISIBLE:
            exception_class = ElementNotVisibleException
        elif status in ErrorCode.INVALID_ELEMENT_STATE:
            exception_class = InvalidElementStateException
        elif status in ErrorCode.INVALID_SELECTOR \
                or status in ErrorCode.INVALID_XPATH_SELECTOR \
                or status in ErrorCode.INVALID_XPATH_SELECTOR_RETURN_TYPER:
            exception_class = InvalidSelectorException
        elif status in ErrorCode.ELEMENT_IS_NOT_SELECTABLE:
            exception_class = ElementNotSelectableException
        elif status in ErrorCode.ELEMENT_NOT_INTERACTABLE:
            exception_class = ElementNotInteractableException
        elif status in ErrorCode.INVALID_COOKIE_DOMAIN:
            exception_class = InvalidCookieDomainException
        elif status in ErrorCode.UNABLE_TO_SET_COOKIE:
            exception_class = UnableToSetCookieException
        elif status in ErrorCode.TIMEOUT:
            exception_class = TimeoutException
        elif status in ErrorCode.SCRIPT_TIMEOUT:
            exception_class = TimeoutException
        elif status in ErrorCode.UNKNOWN_ERROR:
            exception_class = WebDriverException
        elif status in ErrorCode.UNEXPECTED_ALERT_OPEN:
            exception_class = UnexpectedAlertPresentException
        elif status in ErrorCode.NO_ALERT_OPEN:
            exception_class = NoAlertPresentException
        elif status in ErrorCode.IME_NOT_AVAILABLE:
            exception_class = ImeNotAvailableException
        elif status in ErrorCode.IME_ENGINE_ACTIVATION_FAILED:
            exception_class = ImeActivationFailedException
        elif status in ErrorCode.MOVE_TARGET_OUT_OF_BOUNDS:
            exception_class = MoveTargetOutOfBoundsException
        elif status in ErrorCode.JAVASCRIPT_ERROR:
            exception_class = JavascriptException
        elif status in ErrorCode.SESSION_NOT_CREATED:
            exception_class = SessionNotCreatedException
        elif status in ErrorCode.INVALID_ARGUMENT:
            exception_class = InvalidArgumentException
        elif status in ErrorCode.NO_SUCH_COOKIE:
            exception_class = NoSuchCookieException
        elif status in ErrorCode.UNABLE_TO_CAPTURE_SCREEN:
            exception_class = ScreenshotException
        elif status in ErrorCode.ELEMENT_CLICK_INTERCEPTED:
            exception_class = ElementClickInterceptedException
        elif status in ErrorCode.INSECURE_CERTIFICATE:
            exception_class = InsecureCertificateException
        elif status in ErrorCode.INVALID_COORDINATES:
            exception_class = InvalidCoordinatesException
        elif status in ErrorCode.INVALID_SESSION_ID:
            exception_class = InvalidSessionIdException
        elif status in ErrorCode.UNKNOWN_METHOD:
            exception_class = UnknownMethodException
        else:
            exception_class = WebDriverException
        if value == '' or value is None:
            value = response['value']
        if isinstance(value, basestring):
            if exception_class == ErrorInResponseException:
                raise exception_class(response, value)
            raise exception_class(value)
        if message == "" and 'message' in value:
            message = value['message']

        screen = None
        if 'screen' in value:
            screen = value['screen']

        stacktrace = None
        if 'stackTrace' in value and value['stackTrace']:
            stacktrace = []
            try:
                for frame in value['stackTrace']:
                    line = self._value_or_default(frame, 'lineNumber', '')
                    file = self._value_or_default(frame, 'fileName', '<anonymous>')
                    if line:
                        file = "%s:%s" % (file, line)
                    meth = self._value_or_default(frame, 'methodName', '<anonymous>')
                    if 'className' in frame:
                        meth = "%s.%s" % (frame['className'], meth)
                    msg = "    at %s (%s)"
                    msg = msg % (meth, file)
                    stacktrace.append(msg)
            except TypeError:
                pass
        if exception_class == ErrorInResponseException:
            raise exception_class(response, message)
        elif exception_class == UnexpectedAlertPresentException:
            alert_text = None
            if 'data' in value:
                alert_text = value['data'].get('text')
            elif 'alert' in value:
                alert_text = value['alert'].get('text')
            raise exception_class(message, screen, stacktrace, alert_text)
>       raise exception_class(message, screen, stacktrace)
E       selenium.common.exceptions.WebDriverException: Message: unknown error: cannot connect to chrome at 127.0.0.1:9222
E       from chrome not reachable

../../venv/lib/python3.8/site-packages/selenium/webdriver/remote/errorhandler.py:242: WebDriverException
